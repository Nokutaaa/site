<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Nokuta</title>
<link rel="icon" href="favicon.jpg" type="image/jpg" />
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
<style>
  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow: hidden;
    font-family: 'Poppins', sans-serif;
    background: black;
  }
  #bg-video {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    object-fit: cover;
    z-index: -10;
  }
  #logo {
    position: fixed;
    top: 50%;
    left: 50%;
    width: auto;
    height: 80px;
    transform: translate(-50%, -50%);
    z-index: 1000;
    pointer-events: none;
    opacity: 0;
    animation: fadeIn 1.2s forwards;
  }
  .floating-video {
    position: fixed;
    width: 220px;
    height: 124px;
    border-radius: 8px;
    object-fit: cover;
    filter: blur(1.3px);
    opacity: 0.75;
    cursor: pointer;
    transition: filter 0.3s ease, opacity 0.3s ease;
    user-select: none;
    animation: fadeIn 1.2s forwards;
    z-index: 10;
  }
  .floating-video:hover {
    filter: blur(0);
    opacity: 1;
    z-index: 1001;
  }
  #fullscreen-video {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 70vw;
    max-width: 1280px;
    max-height: 80vh;
    border-radius: 12px;
    box-shadow: 0 0 30px rgba(0,0,0,0.7);
    z-index: 11000;
    display: none;
    background: black;
  }
  #fullscreen-video video {
    width: 100%;
    height: 100%;
    border-radius: 12px;
    object-fit: contain;
  }
  @keyframes fadeIn {
    to {opacity: 1;}
  }
</style>
</head>
<body>

<video id="bg-video" autoplay muted loop playsinline>
  <source src="fond.mp4" type="video/mp4" />
  Votre navigateur ne supporte pas la vid√©o HTML5.
</video>

<img id="logo" src="logo1.png" alt="Logo Nokuta" />

<div id="videos-container"></div>

<div id="fullscreen-video">
  <video controls playsinline></video>
</div>

<script>
  const videosSrc = [
    "video1.mp4",
    "video2.mp4",
    "video3.mp4",
    "video4.mp4",
    "video5.mp4",
    "video6.mp4"
  ];

  const logo = document.getElementById('logo');
  const container = document.getElementById('videos-container');
  const fullscreenWrapper = document.getElementById('fullscreen-video');
  const fullscreenVideo = fullscreenWrapper.querySelector('video');

  // Ellipse parameters for base positions (centered on viewport center)
  const ellipse = {
    centerX: window.innerWidth / 2,
    centerY: window.innerHeight / 2,
    radiusX: window.innerWidth / 2.5,
    radiusY: window.innerHeight / 3,
  };

  // Minimum distance from edges
  const edgeMargin = 80;

  // Positions array for base coords and floating offsets
  let positions = [];

  // Initialize 6 fixed base positions on ellipse, spaced evenly by angle
  for (let i = 0; i < videosSrc.length; i++) {
    const angle = (i * (360 / videosSrc.length) - 90) * Math.PI / 180; // start top center, clockwise
    let x = ellipse.centerX + ellipse.radiusX * Math.cos(angle);
    let y = ellipse.centerY + ellipse.radiusY * Math.sin(angle);
    positions.push({
      baseX: x,
      baseY: y,
      offsetX: Math.random() * 6 - 3,
      offsetY: Math.random() * 6 - 3,
      offsetSpeedX: (Math.random() * 0.02 + 0.005),
      offsetSpeedY: (Math.random() * 0.015 + 0.005),
      angleX: Math.random() * 2 * Math.PI,
      angleY: Math.random() * 2 * Math.PI,
      width: 220,
      height: 124,
    });
  }

  // Repel function to keep minimum distance 80px from edges, logo & other videos
  function repelPositions() {
    const logoRect = logo.getBoundingClientRect();
    const minDist = 80;

    function dist(a, b) {
      return Math.sqrt((a.baseX - b.baseX)**2 + (a.baseY - b.baseY)**2);
    }

    let changed;
    do {
      changed = false;
      for(let i = 0; i < positions.length; i++) {
        // Keep away from edges
        positions[i].baseX = Math.min(Math.max(positions[i].baseX, minDist + positions[i].width/2), window.innerWidth - minDist - positions[i].width/2);
        positions[i].baseY = Math.min(Math.max(positions[i].baseY, minDist + positions[i].height/2), window.innerHeight - minDist - positions[i].height/2);

        // Keep away from logo
        const dxLogo = positions[i].baseX - (logoRect.left + logoRect.width/2);
        const dyLogo = positions[i].baseY - (logoRect.top + logoRect.height/2);
        const distLogo = Math.sqrt(dxLogo*dxLogo + dyLogo*dyLogo);
        if(distLogo < minDist + positions[i].width/2 + Math.max(logoRect.width, logoRect.height)/2) {
          const angleAway = Math.atan2(dyLogo, dxLogo);
          positions[i].baseX = (logoRect.left + logoRect.width/2) + (minDist + positions[i].width/2 + Math.max(logoRect.width, logoRect.height)/2) * Math.cos(angleAway);
          positions[i].baseY = (logoRect.top + logoRect.height/2) + (minDist + positions[i].height/2 + Math.max(logoRect.width, logoRect.height)/2) * Math.sin(angleAway);
          changed = true;
        }

        // Keep away from other videos
        for(let j = 0; j < positions.length; j++) {
          if(i === j) continue;
          const d = dist(positions[i], positions[j]);
          if(d < minDist + positions[i].width/2 + positions[j].width/2) {
            const angleAway = Math.atan2(positions[i].baseY - positions[j].baseY, positions[i].baseX - positions[j].baseX);
            positions[i].baseX = positions[j].baseX + (minDist + positions[i].width/2 + positions[j].width/2) * Math.cos(angleAway);
            positions[i].baseY = positions[j].baseY + (minDist + positions[i].height/2 + positions[j].height/2) * Math.sin(angleAway);
            changed = true;
          }
        }
      }
    } while(changed);
  }

  // Apply repel to initial positions
  repelPositions();

  // Create video elements
  let videoElements = [];

  function createVideos() {
    container.innerHTML = '';
    videoElements = [];

    for(let i = 0; i < videosSrc.length; i++) {
      const vid = document.createElement('video');
      vid.src = videosSrc[i];
      vid.className = 'floating-video';
      vid.autoplay = true;
      vid.muted = true;
      vid.loop = true;
      vid.playsInline = true;
      vid.style.width = positions[i].width + 'px';
      vid.style.height = positions[i].height + 'px';
      vid.style.zIndex = 10;
      container.appendChild(vid);
      videoElements.push(vid);

      vid.addEventListener('click', () => {
        fullscreenVideo.src = vid.src;
        fullscreenVideo.currentTime = 0;
        fullscreenVideo.volume = 0.35;
        fullscreenWrapper.style.display = 'block';
        fullscreenVideo.play();
      });
    }
  }

  createVideos();

  // Animate floating subtle movement around base points
  function animate() {
    for(let i = 0; i < positions.length; i++) {
      const pos = positions[i];
      pos.angleX += pos.offsetSpeedX;
      pos.angleY += pos.offsetSpeedY;

      // Small elliptical floating movement (+/- 8px)
      const floatX = Math.cos(pos.angleX) * 8;
      const floatY = Math.sin(pos.angleY) * 6;

      const x = pos.baseX + floatX - positions[i].width/2;
      const y = pos.baseY + floatY - positions[i].height/2;

      videoElements[i].style.transform = `translate(${x}px, ${y}px)`;
    }
    requestAnimationFrame(animate);
  }

  animate();

  // Close fullscreen video if click outside video
  fullscreenWrapper.addEventListener('click', e => {
    if(e.target === fullscreenWrapper) {
      fullscreenVideo.pause();
      fullscreenVideo.src = '';
      fullscreenWrapper.style.display = 'none';
    }
  });

  // Handle window resize: recalc ellipse center and repel positions
  window.addEventListener('resize', () => {
    ellipse.centerX = window.innerWidth / 2;
    ellipse.centerY = window.innerHeight / 2;

    for(let i = 0; i < positions.length; i++) {
      const angle = (i * (360 / videosSrc.length) - 90) * Math.PI / 180;
      positions[i].baseX = ellipse.centerX + ellipse.radiusX * Math.cos(angle);
      positions[i].baseY = ellipse.centerY + ellipse.radiusY * Math.sin(angle);
    }
    repelPositions();
  });
</script>

</body>
</html>
