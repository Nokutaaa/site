<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Nokuta - Carrousel Hexagonal 3D</title>
<link rel="icon" href="favicon.jpg" type="image/jpg" />
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
<style>
  html, body {
    height: 100%;
    margin: 0; padding: 0;
    font-family: 'Poppins', sans-serif;
    background: white;
    color: black;
    overflow-x: hidden;
  }

  body {
    display: flex;
    justify-content: center;
    align-items: center;
    perspective: 1500px; /* perspective 3D */
    height: 100vh;
  }

  #bg-video {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    object-fit: cover;
    z-index: -10;
    filter: brightness(0.5);
  }

  .carousel-container {
    position: relative;
    width: 1100px;
    height: 400px;
    transform-style: preserve-3d;
  }

  .carousel {
    position: relative;
    width: 1100px;
    height: 400px;
    margin: 0 auto;
    transform-style: preserve-3d;
    transition: transform 1s ease;
  }

  video {
    position: absolute;
    width: 420px;
    height: 240px;
    border-radius: 8px;
    object-fit: cover;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(0,0,0,0.3);
    transition: filter 0.5s ease, opacity 0.5s ease, transform 0.5s ease;
    user-select: none;
  }

  .video-center {
    filter: none !important;
    opacity: 1 !important;
    transform: translateZ(200px) scale(1.2) !important;
    z-index: 100 !important;
    cursor: default;
  }

  .video-side {
    filter: blur(3px) grayscale(50%);
    opacity: 0.6;
    z-index: 1;
  }

  .video-side:hover {
    filter: blur(1px) grayscale(20%);
    opacity: 0.9;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
  }

  .logo-container {
    position: absolute; top: 60px; left: 60px; z-index: 1000;
  }

</style>
</head>
<body>

<div class="logo-container">
  <img src="logo1.png" alt="Logo" style="height:50px;" />
</div>

<video autoplay muted loop playsinline id="bg-video">
  <source src="fond.mp4" type="video/mp4" />
  Votre navigateur ne supporte pas la vidéo HTML5.
</video>

<div class="carousel-container">
  <div class="carousel" id="carousel"></div>
</div>

<script>
  const videos = ["video1.mp4", "video2.mp4", "video3.mp4", "video4.mp4", "video5.mp4", "video6.mp4"];
  const carousel = document.getElementById('carousel');
  const total = videos.length;
  let currentIndex = 0;

  // Angle réduit à 10°
  const angleStep = 10;
  const radius = 600; // plus large pour étaler le carrousel

  function startAtOneSecond(videoElem) {
    function seekAndPlay() {
      if (videoElem.currentTime < 1) {
        videoElem.currentTime = 1;
      }
      videoElem.play().catch(() => {});
      videoElem.removeEventListener('loadedmetadata', seekAndPlay);
    }
    if (videoElem.readyState >= 1) {
      seekAndPlay();
    } else {
      videoElem.addEventListener('loadedmetadata', seekAndPlay);
    }
  }

  function render() {
    carousel.innerHTML = '';

    for(let i = 0; i < total; i++) {
      const vidIdx = (currentIndex + i) % total;
      const video = document.createElement('video');

      video.src = videos[vidIdx];
      video.muted = true;
      video.loop = true;
      video.autoplay = true;
      video.playsInline = true;
      video.setAttribute('preload', 'auto');
      video.controls = (i === 0);

      // Calcul rotation avec angle réduit
      const rotateY = i * angleStep;

      // Position 3D circulaire
      video.style.transform = `rotateY(${rotateY}deg) translateZ(${radius}px)`;

      if(i === 0) {
        video.classList.add('video-center');
      } else {
        video.classList.add('video-side');
      }

      if(videos[vidIdx] === "video3.mp4" || videos[vidIdx] === "video5.mp4") {
        startAtOneSecond(video);
      }

      video.addEventListener('click', () => {
        currentIndex = vidIdx;
        render();
      });

      carousel.appendChild(video);
    }

    carousel.style.transform = `translateZ(-${radius}px) rotateY(-${currentIndex * angleStep}deg)`;
  }

  window.addEventListener('keydown', e => {
    if(e.key === 'ArrowRight') {
      currentIndex = (currentIndex + 1) % total;
      render();
    } else if(e.key === 'ArrowLeft') {
      currentIndex = (currentIndex - 1 + total) % total;
      render();
    }
  });

  render();
</script>

</body>
</html>
