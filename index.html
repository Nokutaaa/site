<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Vidéos flottantes avec logo central</title>
<style>
  html, body {
    margin: 0; padding: 0;
    height: 100%;
    overflow: hidden;
    background: #111;
    font-family: Arial, sans-serif;
  }
  body {
    position: relative;
  }

  #logo {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10000;
    pointer-events: none; /* pour ne pas gêner le clic sur vidéos */
    user-select: none;
    width: 150px;
    height: 150px;
    background: url('logo1.png') no-repeat center center;
    background-size: contain;
  }

  .floating-video {
    position: absolute;
    border-radius: 10px;
    filter: blur(1.5px);
    opacity: 0.75;
    cursor: pointer;
    object-fit: cover;
    transition: filter 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 0 8px rgba(0,0,0,0.5);
    z-index: 1;
  }

  .floating-video:hover {
    filter: none;
    opacity: 1;
    box-shadow: 0 0 20px rgba(255,255,255,0.8);
    z-index: 1000;
  }

  .floating-video.selected {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 80vw !important;
    height: auto !important;
    max-height: 80vh !important;
    opacity: 1 !important;
    filter: none !important;
    box-shadow: 0 0 30px rgba(255,255,255,1) !important;
    z-index: 10001 !important;
    cursor: default !important;
  }
</style>
</head>
<body>

<div id="logo"></div>

<script>
  const videosSrc = [
    'video1.mp4',
    'video2.mp4',
    'video3.mp4',
    'video4.mp4',
    'video5.mp4',
    'video6.mp4'
  ];

  const videoCount = 8; // nombre de vidéos flottantes à afficher
  const floatingVideos = [];
  const containerWidth = window.innerWidth;
  const containerHeight = window.innerHeight;

  const logo = document.getElementById('logo');
  // On récupère la zone du logo pour éviter que vidéos passent dessus
  let logoRect;

  // Recalcul du rect du logo (fixe, mais au resize on peut recalculer)
  function updateLogoRect() {
    logoRect = logo.getBoundingClientRect();
  }
  updateLogoRect();
  window.addEventListener('resize', () => {
    updateLogoRect();
  });

  // Vérifie si deux rectangles se chevauchent
  function isOverlap(rect1, rect2) {
    return !(rect1.right < rect2.left ||
             rect1.left > rect2.right ||
             rect1.bottom < rect2.top ||
             rect1.top > rect2.bottom);
  }

  // Vérifie si une zone donnée chevauche une autre zone ou le logo
  function canPlace(x, y, width, height) {
    const newRect = {
      left: x,
      top: y,
      right: x + width,
      bottom: y + height
    };
    // Check logo
    if (isOverlap(newRect, logoRect)) return false;

    // Check déjà placées
    for(const v of floatingVideos) {
      const r = v.rect;
      if (isOverlap(newRect, r)) return false;
    }
    return true;
  }

  // Cherche une position aléatoire pour une vidéo sans superposition
  function findPosition(width, height) {
    const maxAttempts = 1000;
    for(let i=0; i<maxAttempts; i++) {
      const x = Math.random() * (containerWidth - width);
      const y = Math.random() * (containerHeight - height);
      if(canPlace(x, y, width, height)) return {x, y};
    }
    // fallback (rare)
    return {x: 0, y: 0};
  }

  // Crée et place une vidéo flottante sur la page
  function createFloatingVideo(src) {
    const video = document.createElement('video');
    video.src = src;
    video.muted = true;
    video.loop = true;
    video.autoplay = true;
    video.playsInline = true;
    video.preload = 'auto';
    video.classList.add('floating-video');

    // taille aléatoire entre 120 et 250px de largeur, ratio 16:9
    const width = 120 + Math.random() * 130;
    const height = width * 9 / 16;
    video.style.width = width + 'px';
    video.style.height = height + 'px';

    const pos = findPosition(width, height);
    video.style.left = pos.x + 'px';
    video.style.top = pos.y + 'px';

    // Sauvegarde la zone pour les prochaines vérifs
    floatingVideos.push({
      video,
      rect: {left: pos.x, top: pos.y, right: pos.x + width, bottom: pos.y + height},
      baseLeft: pos.x,
      baseTop: pos.y,
      width,
      height
    });

    // Click sur la vidéo = afficher en grand
    video.addEventListener('click', (e) => {
      e.stopPropagation();
      if(video.classList.contains('selected')) {
        deselectAll();
      } else {
        selectVideo(video);
      }
    });

    document.body.appendChild(video);
  }

  // Affiche une vidéo en grand, désactive interaction des autres
  function selectVideo(selectedVideo) {
    floatingVideos.forEach(({video}) => {
      if(video === selectedVideo){
        video.classList.add('selected');
        video.controls = true;
        video.muted = false;
        video.play();
        video.style.zIndex = '10001';
      } else {
        video.style.filter = 'blur(2px)';
        video.style.opacity = '0.5';
        video.style.pointerEvents = 'none';
        video.controls = false;
      }
    });
  }

  // Désélectionne toutes les vidéos
  function deselectAll() {
    floatingVideos.forEach(({video}) => {
      video.classList.remove('selected');
      video.style.filter = 'blur(1.5px)';
      video.style.opacity = '0.75';
      video.style.pointerEvents = 'auto';
      video.controls = false;
      video.muted = true;
      video.play();
      video.style.zIndex = '1';
    });
  }

  // Crée toutes les vidéos
  for(let i=0; i<videoCount; i++) {
    createFloatingVideo(videosSrc[i % videosSrc.length]);
  }

  // Effet de flottement (oscillation) sur les vidéos non sélectionnées
  function animate(time=0) {
    floatingVideos.forEach(({video, baseLeft, baseTop, width, height}, i) => {
      if(!video.classList.contains('selected')) {
        // oscillation horizontale et verticale
        const offsetX = 5 * Math.sin(time / 1000 + i);
        const offsetY = 3 * Math.cos(time / 800 + i);
        video.style.left = (baseLeft + offsetX) + 'px';
        video.style.top = (baseTop + offsetY) + 'px';
      }
    });
    requestAnimationFrame(animate);
  }
  animate();

  // Clic hors vidéo désélectionne la vidéo en grand
  document.body.addEventListener('click', () => {
    deselectAll();
  });

  // Ajuste la taille du container / repositionne les vidéos au resize
  window.addEventListener('resize', () => {
    // Met à jour les dimensions
    const newWidth = window.innerWidth;
    const newHeight = window.innerHeight;
    if(newWidth !== containerWidth || newHeight !== containerHeight){
      // Pas simple de repositionner sans recalcule complet, 
      // ici on recharge la page, pour garder simplicité et éviter chevauchement
      location.reload();
    }
  });

</script>

</body>
</html>
