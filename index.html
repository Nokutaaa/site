<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Nokuta - Vidéos défilantes</title>
<link rel="icon" href="favicon.jpg" type="image/jpg" />
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
<style>
  body {
    background-color: black;
    color: white;
    font-family: 'Poppins', sans-serif;
    margin: 0; padding: 0;
    overflow-x: hidden;
    height: 100vh;
    position: relative;
  }

  #bg-video {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    object-fit: cover;
    z-index: -10;
    filter: brightness(0.5);
  }

  header {
    position: fixed;
    top: 20px; /* un peu plus bas */
    left: 50%;
    transform: translateX(-50%);
    z-index: 10000;
    width: 100%;
    text-align: center;
  }

  .logo {
    height: 60px;
    user-select: none;
  }

  .floating-video {
    position: absolute;
    opacity: 0.6;
    filter: blur(2px);
    pointer-events: auto;
    border-radius: 8px;
    animation-name: floatHorizontal;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
    transition: opacity 0.3s ease, filter 0.3s ease, box-shadow 0.3s ease;
    object-fit: cover;
  }

  .floating-video:hover {
    opacity: 0.95;
    filter: blur(0.5px);
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
    z-index: 10;
  }

  @keyframes floatHorizontal {
    from {
      transform: translateX(100vw);
    }
    to {
      transform: translateX(-120vw);
    }
  }
</style>
</head>
<body>

<header>
  <img src="logo1.png" alt="Logo" class="logo" />
</header>

<video autoplay muted loop playsinline id="bg-video">
  <source src="fond.mp4" type="video/mp4" />
  Votre navigateur ne supporte pas la vidéo HTML5.
</video>

<script>
  const videosSrc = ["video1.mp4", "video2.mp4", "video3.mp4", "video4.mp4", "video5.mp4", "video6.mp4"];
  const maxVideosOnScreen = 10;
  const containerHeight = window.innerHeight;
  const containerWidth = window.innerWidth;

  // Tableau pour suivre les positions verticales utilisées (pour éviter superposition verticale)
  const usedTops = [];

  // Fonction pour trouver une position verticale libre (éviter chevauchement vertical)
  function findFreeTop(height) {
    const step = 30; // espacement minimum vertical
    for(let top = 50; top < containerHeight - height - 50; top += step) {
      // Vérifier chevauchement avec les positions déjà prises
      let conflict = false;
      for(let used of usedTops) {
        if(Math.abs(used - top) < step) {
          conflict = true;
          break;
        }
      }
      if(!conflict) {
        usedTops.push(top);
        return top;
      }
    }
    // Si rien trouvé, renvoyer un random à défaut
    return Math.random() * (containerHeight - height - 100) + 50;
  }

  function createFloatingVideo(src) {
    const video = document.createElement('video');
    video.src = src;
    video.muted = true;
    video.loop = true;
    video.autoplay = true;
    video.playsInline = true;
    video.preload = 'auto';
    video.className = 'floating-video';

    // Taille aléatoire entre 150 et 300px de large, avec ratio 16/9
    const width = 150 + Math.random() * 150;
    const height = width * 9 / 16;

    video.style.width = `${width}px`;
    video.style.height = `${height}px`;

    // Position verticale sans superposition
    const top = findFreeTop(height);
    video.style.top = `${top}px`;

    // Position horizontale de départ (hors écran à droite)
    video.style.left = `${containerWidth + Math.random() * 300}px`;

    // Durée d'animation entre 50 et 80 secondes (plus lent)
    const duration = 50 + Math.random() * 30;

    video.style.animationDuration = `${duration}s`;

    // Supprimer la position verticale de la vidéo quand l'animation est finie (pour réutiliser)
    video.addEventListener('animationend', () => {
      const index = usedTops.indexOf(top);
      if(index > -1) usedTops.splice(index, 1);
      video.remove();
      spawnVideo(); // relancer une nouvelle vidéo
    });

    // Clic pour agrandir la vidéo au centre
    video.addEventListener('click', () => {
      if(video.classList.contains('selected')) {
        // Deselect: revenir à l'état normal
        video.classList.remove('selected');
        resumeFloatingVideos();
      } else {
        selectVideo(video);
      }
    });

    return video;
  }

  // Gestion sélection vidéo
  function selectVideo(video) {
    // Stop et cacher les autres vidéos en fond, garder un léger flottement
    document.querySelectorAll('.floating-video').forEach(v => {
      if(v !== video) {
        v.style.animationPlayState = 'paused';
        v.style.filter = 'blur(1px)';
        v.style.opacity = '0.3';
      }
    });

    // Style vidéo sélectionnée
    video.style.position = 'fixed';
    video.style.top = '50%';
    video.style.left = '50%';
    video.style.transform = 'translate(-50%, -50%) scale(1.5)';
    video.style.zIndex = 10000;
    video.style.opacity = 1;
    video.style.filter = 'none';
    video.style.animationPlayState = 'paused';
    video.classList.add('selected');
  }

  function resumeFloatingVideos() {
    document.querySelectorAll('.floating-video').forEach(v => {
      v.style.position = 'absolute';
      v.style.transform = 'none';
      v.style.animationPlayState = 'running';
      v.style.opacity = 0.6;
      v.style.filter = 'blur(2px)';
      v.style.zIndex = '';
      v.classList.remove('selected');
    });
  }

  function spawnVideo() {
    if(document.querySelectorAll('.floating-video').length >= maxVideosOnScreen) return;

    // Choisir une vidéo aléatoire
    const src = videosSrc[Math.floor(Math.random() * videosSrc.length)];
    const video = createFloatingVideo(src);
    document.body.appendChild(video);
  }

  // Initial spawn : pour avoir la page déjà remplie
  for(let i=0; i < maxVideosOnScreen; i++) {
    spawnVideo();
  }

  // Recalcule container sizes et reset usedTops au resize
  window.addEventListener('resize', () => {
    usedTops.length = 0;
  });
</script>

</body>
</html>
